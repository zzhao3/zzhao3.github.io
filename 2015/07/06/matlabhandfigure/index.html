
 <!DOCTYPE HTML>
<html lang="default">
<head>
  <meta charset="UTF-8">
  
    <title>matlab手轮廓识别与中指指尖检测 | Z-Zone</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Zongyuan Zhao">
    

    
    <meta name="description" content="概要本文将讲述如何利用matlab guide编写手部轮廓检测以及中指指尖识别程序。项目具体需求：

使用matlab guide构建图形用户界面
读取摄像头输入，保存一副图片
在简单背景下识别手部轮廓
识别中指指尖位置

本文使用matlab版本为R2012a。摄像头采集到的图像为1280*720。本文只提供一种解决思路，实测效果受环境影响。
Matlab Guide建立打开matlab，输入">
<meta property="og:type" content="article">
<meta property="og:title" content="matlab手轮廓识别与中指指尖检测">
<meta property="og:url" content="http://zhaozongyuan.com/2015/07/06/matlabhandfigure/index.html">
<meta property="og:site_name" content="Z-Zone">
<meta property="og:description" content="概要本文将讲述如何利用matlab guide编写手部轮廓检测以及中指指尖识别程序。项目具体需求：

使用matlab guide构建图形用户界面
读取摄像头输入，保存一副图片
在简单背景下识别手部轮廓
识别中指指尖位置

本文使用matlab版本为R2012a。摄像头采集到的图像为1280*720。本文只提供一种解决思路，实测效果受环境影响。
Matlab Guide建立打开matlab，输入">
<meta property="og:image" content="http://ww2.sinaimg.cn/mw690/4aa86401gw1etvkdro4obj20fs0bbgmf.jpg">
<meta property="og:image" content="http://ww2.sinaimg.cn/mw690/4aa86401gw1etvkdt9tyaj20f50b53z6.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/mw690/4aa86401gw1etvkdw2il8j20jb0cvab6.jpg">
<meta property="og:image" content="http://ww4.sinaimg.cn/mw690/4aa86401gw1etvkdxkq05j20fe0chmyi.jpg">
<meta property="og:image" content="http://ww3.sinaimg.cn/large/4aa86401gw1etvkay5cshj20zk0k045s.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/4aa86401gw1etvkb3kjuhj20zk0k00za.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/4aa86401gw1etvkb8doz5j20zk0k0jrz.jpg">
<meta property="og:image" content="http://ww3.sinaimg.cn/large/4aa86401gw1etvkbavskaj20zk0k0gmb.jpg">
<meta property="og:image" content="http://ww3.sinaimg.cn/large/4aa86401gw1etvkaum65kj20lh0d340z.jpg">
<meta property="og:updated_time" content="2015-07-08T11:05:46.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="matlab手轮廓识别与中指指尖检测">
<meta name="twitter:description" content="概要本文将讲述如何利用matlab guide编写手部轮廓检测以及中指指尖识别程序。项目具体需求：

使用matlab guide构建图形用户界面
读取摄像头输入，保存一副图片
在简单背景下识别手部轮廓
识别中指指尖位置

本文使用matlab版本为R2012a。摄像头采集到的图像为1280*720。本文只提供一种解决思路，实测效果受环境影响。
Matlab Guide建立打开matlab，输入">

    
    <link rel="alternative" href="/atom.xml" title="Z-Zone" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/cool.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Z-Zone" title="Z-Zone"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Z-Zone">Z-Zone</a></h1>
				<h2 class="blog-motto">Zongyuan’s Space</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About &amp; Contact</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:zhaozongyuan.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/06/matlabhandfigure/" title="matlab手轮廓识别与中指指尖检测" itemprop="url">matlab手轮廓识别与中指指尖检测</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Zongyuan Zhao" target="_blank" itemprop="author">Zongyuan Zhao</a>
		
  <p class="article-time">
    <time datetime="2015-07-06T11:13:49.000Z" itemprop="datePublished"> Published 2015-07-06</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#概要"><span class="toc-number">1.</span> <span class="toc-text">概要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Matlab_Guide建立"><span class="toc-number">2.</span> <span class="toc-text">Matlab Guide建立</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#添加按钮（Button）"><span class="toc-number">2.1.</span> <span class="toc-text">添加按钮（Button）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加图片显示（axes）"><span class="toc-number">2.2.</span> <span class="toc-text">添加图片显示（axes）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加按键动作"><span class="toc-number">2.3.</span> <span class="toc-text">添加按键动作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#执行"><span class="toc-number">2.4.</span> <span class="toc-text">执行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#全局变量与变量调用"><span class="toc-number">3.</span> <span class="toc-text">全局变量与变量调用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#全局变量"><span class="toc-number">3.1.</span> <span class="toc-text">全局变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用UserData进行参数传递"><span class="toc-number">3.2.</span> <span class="toc-text">使用UserData进行参数传递</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#摄像头读取"><span class="toc-number">4.</span> <span class="toc-text">摄像头读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#视频流显示"><span class="toc-number">4.1.</span> <span class="toc-text">视频流显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#截取一帧图像"><span class="toc-number">4.2.</span> <span class="toc-text">截取一帧图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图像与矩阵"><span class="toc-number">4.3.</span> <span class="toc-text">图像与矩阵</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#轮廓提取"><span class="toc-number">5.</span> <span class="toc-text">轮廓提取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#梯度计算"><span class="toc-number">5.1.</span> <span class="toc-text">梯度计算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#膨胀与腐蚀"><span class="toc-number">5.2.</span> <span class="toc-text">膨胀与腐蚀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#手部填充"><span class="toc-number">5.3.</span> <span class="toc-text">手部填充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#轮廓精提取"><span class="toc-number">5.4.</span> <span class="toc-text">轮廓精提取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#中指指尖检测"><span class="toc-number">6.</span> <span class="toc-text">中指指尖检测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#重心定位"><span class="toc-number">6.1.</span> <span class="toc-text">重心定位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#寻找最远点"><span class="toc-number">6.2.</span> <span class="toc-text">寻找最远点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中指位置标示"><span class="toc-number">6.3.</span> <span class="toc-text">中指位置标示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中指坐标显示"><span class="toc-number">6.4.</span> <span class="toc-text">中指坐标显示</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">7.</span> <span class="toc-text">总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#缺点与限制"><span class="toc-number">7.1.</span> <span class="toc-text">缺点与限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#可能的改进"><span class="toc-number">7.2.</span> <span class="toc-text">可能的改进</span></a></li></ol></li></ol>
		
		</div>
		
		<h2 id="概要">概要</h2><p>本文将讲述如何利用matlab guide编写手部轮廓检测以及中指指尖识别程序。<br>项目具体需求：</p>
<ol>
<li>使用matlab guide构建图形用户界面</li>
<li>读取摄像头输入，保存一副图片</li>
<li>在简单背景下识别手部轮廓</li>
<li>识别中指指尖位置</li>
</ol>
<p>本文使用matlab版本为R2012a。摄像头采集到的图像为1280*720。<br>本文只提供一种解决思路，实测效果受环境影响。</p>
<h2 id="Matlab_Guide建立">Matlab Guide建立</h2><p>打开matlab，输入</p>
<pre><code>guide
</code></pre><p>之后会显示新建guide的界面，填写项目名称与存储位置即可。</p>
<p><img src="http://ww2.sinaimg.cn/mw690/4aa86401gw1etvkdro4obj20fs0bbgmf.jpg" alt="Create guide"></p>
<p>这时会在该位置生成<code>.m</code>与<code>.fig</code>文件，该文件分别为matlab guide的命令代码文件与图形设计界面。</p>
<h3 id="添加按钮（Button）">添加按钮（Button）</h3><p>在图形设计界面的左边栏找到Button控件，拖拽到相应位置。</p>
<p>双击拖拽好的Button，就可以看到该按键的各种设置。找到String，修改其内容，即可改变Button中显示的内容。</p>
<h3 id="添加图片显示（axes）">添加图片显示（axes）</h3><p>在图形设计界面的左边栏找到axes控件，拖拽到相应位置。</p>
<p><img src="http://ww2.sinaimg.cn/mw690/4aa86401gw1etvkdt9tyaj20f50b53z6.jpg" alt="Button and axes"></p>
<h3 id="添加按键动作">添加按键动作</h3><p>对于button可以添加按键动作。选中一个button，右键-&gt;view callbacks-&gt;callback</p>
<p><img src="http://ww1.sinaimg.cn/mw690/4aa86401gw1etvkdw2il8j20jb0cvab6.jpg" alt="Callback"></p>
<p>这时会跳转到<code>.m</code>文件中相应的代码段。类似如下代码</p>
<pre><code>% --- Executes <span class="keyword">on</span> button press <span class="keyword">in</span> pushbutton1.
<span class="keyword">function</span> pushbutton1_Callback(hObject, eventdata, <span class="keyword">handles</span>)
% hObject    handle <span class="keyword">to</span> pushbutton1 (see GCBO)
% eventdata  reserved - <span class="keyword">to</span> be defined <span class="keyword">in</span> a future version <span class="keyword">of</span> MATLAB
% <span class="keyword">handles</span>    <span class="keyword">structure</span> <span class="keyword">with</span> <span class="keyword">handles</span> <span class="keyword">and</span> user data (see GUIDATA)
</code></pre><p>每一个button的动作成为一个callback function。在这些代码的下面就可以编写相应的响应动作。具体可以见示例中的内容。</p>
<h3 id="执行">执行</h3><p>在保存之后，点击上方的绿色小三角按钮（<code>.m</code>与<code>.fig</code>文件里都有），即可执行程序。</p>
<p><strong>示例</strong>：</p>
<pre><code><span class="comment">%在gui界面中，通过点击button显示一副图片</span>
<span class="comment">%在刚才callback function代码的下面加入下面代码即可</span>
<span class="variable">I</span>=<span class="function_or_atom">imread</span>(<span class="string">'D:\image.jpg'</span>);<span class="comment">%图片位于D盘根目录下，读到I中</span>
<span class="function_or_atom">axes</span>(<span class="function_or_atom">handles</span>.<span class="function_or_atom">axes1</span>);<span class="comment">%该动作作用于名为axes1的axes上</span>
<span class="function_or_atom">imshow</span>(<span class="variable">I</span>);<span class="comment">%显示I，即图片</span>
</code></pre><p><strong>注</strong>：</p>
<ol>
<li>在matlab中，%表示注释，即%后面的文字都不会被matlab“看到”</li>
<li>axes的变量名可以通过双击-&gt;tag来修改。一般不做修改。</li>
<li>在设计完界面后，建议先保存（ctrl+s），再修改callback。同样的，修改callback后也要记得保存。</li>
</ol>
<h2 id="全局变量与变量调用">全局变量与变量调用</h2><p>matlab中，每个callback function之中的变量，其作用域只在该function中。通俗的说，两个function之间是不能随意读取变量的。那么如何解决这个问题呢？有下面两种方法：</p>
<h3 id="全局变量">全局变量</h3><p>可以通过设置一个变量为全局变量，实现不同函数中的调用。</p>
<p>全局变量需要在<code>.m</code>文件中设置。具体用法如下。</p>
<pre><code><span class="comment">% Get default command line output from handles structure</span>
varargout<span class="cell">{<span class="number">1</span>}</span> = handles.output;
<span class="comment">%在这里进行全局变量的初始化</span>
<span class="keyword">global</span> vid;<span class="comment">%添加全局变量vid</span>
vid=videoinput(<span class="string">'winvideo'</span>,<span class="number">1</span>);<span class="comment">%将vid赋值，这里为输入的视频流 </span>
<span class="comment">%......其他相关代码</span>
<span class="comment">%在callback function中</span>
<span class="keyword">global</span> vid;<span class="comment">%调用vid</span>
usbVidRes=get(vid, <span class="string">'videoResolution'</span>);<span class="comment">%可以在该callback中使用vid了</span>
<span class="comment">%......其他相关代码</span>
</code></pre><p><strong>注意</strong>:因为matlab中的赋值是调用句柄，所以很可能因为在一个callback中改变了全局变量，导致另一个callback中调用的时候发生错误。因此，除非你有绝对把握，或者是这个变量不会被改变的时候，使用全局变量。</p>
<h3 id="使用UserData进行参数传递">使用UserData进行参数传递</h3><p>每个function都有一个<code>userdata</code>的定义域，可以通过该数据区域来临时存储数据。使用<code>set</code>与<code>get</code>来进行赋值与取值。具体用法如下</p>
<pre><code>    <span class="function"><span class="keyword">function</span> <span class="title">pushbutton1_Callback</span><span class="params">(hObject, eventdata, handles)</span></span>
<span class="comment">%function1中存储数据</span>
I=imread(<span class="string">'D:\image.jpg'</span>);
set(gcbf, <span class="string">'UserData'</span>, I);<span class="comment">%将I存储在UserData中，命名为gcbf</span>

<span class="function"><span class="keyword">function</span> <span class="title">pushbutton2_Callback</span><span class="params">(hObject, eventdata, handles)</span></span>
<span class="comment">%function2中调用数据</span>
I2=get(gcbf, <span class="string">'UserData'</span>);<span class="comment">%调用UserData中的数据</span>
</code></pre><p><strong>注意</strong>:一个<code>UserData</code>区域只能存储一个变量，如果再存储其他变量，会将前一个变量覆盖掉。    </p>
<p>*本段参考了<a href="http://www.cnblogs.com/duanp/archive/2008/11/29/matlab-guide.html" target="_blank" rel="external">Febird’s space的博客</a></p>
<h2 id="摄像头读取">摄像头读取</h2><h3 id="视频流显示">视频流显示</h3><p>从摄像头读入视频流，并在界面中显示。</p>
<pre><code><span class="comment">% Get default command line output from handles structure</span>
varargout<span class="cell">{<span class="number">1</span>}</span> = handles.output;
<span class="keyword">global</span> vid;
vid=videoinput(<span class="string">'winvideo'</span>,<span class="number">1</span>);

<span class="comment">% --- Executes on button press in pushbutton1.</span>
<span class="function"><span class="keyword">function</span> <span class="title">pushbutton1_Callback</span><span class="params">(hObject, eventdata, handles)</span></span>
<span class="comment">% hObject    handle to pushbutton1 (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
imaqhwinfo(<span class="string">'winvideo'</span>);
<span class="keyword">global</span> vid;<span class="comment">%在前面已经设置了全局变量</span>
usbVidRes=get(vid, <span class="string">'videoResolution'</span>);
nBands=get(vid, <span class="string">'NumberOfBands'</span>);
axes(handles.axes1);<span class="comment">%在axes1中显示视频流</span>
hImage=imshow(<span class="built_in">zeros</span>(usbVidRes(<span class="number">2</span>), usbVidRes(<span class="number">1</span>), nBands));
preview(vid, hImage);
</code></pre><h3 id="截取一帧图像">截取一帧图像</h3><p>在刚才输入的视频流中，截取一帧并保存。</p>
<pre><code>% --- Executes <span class="keyword">on</span> button press <span class="keyword">in</span> pushbutton2.
<span class="keyword">function</span> pushbutton2_Callback(hObject, eventdata, <span class="keyword">handles</span>)
% hObject    handle <span class="keyword">to</span> pushbutton2 (see GCBO)
% eventdata  reserved - <span class="keyword">to</span> be defined <span class="keyword">in</span> a future version <span class="keyword">of</span> MATLAB
% <span class="keyword">handles</span>    <span class="keyword">structure</span> <span class="keyword">with</span> <span class="keyword">handles</span> <span class="keyword">and</span> user data (see GUIDATA)
<span class="keyword">global</span> vid;
f=getsnapshot(vid);%截取一帧保存在f中
<span class="keyword">set</span>(gcbf,<span class="comment">'UserData',f);%在后面的程序中会用到这幅图片</span>
imwrite(f, <span class="comment">'D:\camera1.jpg');%将图片保存在硬盘中</span>
axes(<span class="keyword">handles</span>.axes2);%在axes2中显示图片
imshow(f);
</code></pre><p>*本段参考了<a href="http://blog.csdn.net/hzhaly/article/details/18771099" target="_blank" rel="external">西西弗的石头的博客</a></p>
<h3 id="图像与矩阵">图像与矩阵</h3><p>在matlab里，图像以像素矩阵的形式存储。在matlab界面中，可以通过点击右上角中图像的变量来查看矩阵。</p>
<p>在图像处理中，有很多时候默认图像左上角的点的坐标为（0，0），这与我们平时数学中的坐标轴相反。在这里，矩阵中的（1，1）就对应图片中最最上角的那个像素点。图中该像素点的像素值为0。</p>
<p><img src="http://ww4.sinaimg.cn/mw690/4aa86401gw1etvkdxkq05j20fe0chmyi.jpg" alt="image matrix"></p>
<p>有关的矩阵操作将在下面用到时详细说明。</p>
<h2 id="轮廓提取">轮廓提取</h2><p>由于本文要求使用摄像头采集的图像进行手部轮廓提取，虽然背景简单，但是由于光线等影响，图片中不免产生噪声。直接对灰度图进行canny算子的边缘检测效果非常不理想。</p>
<p>因此，本文采用了另一种思路。对图像首先计算其梯度。通过设定梯度的阈值来检测物体的边缘。其中用到了膨胀与腐蚀算子对图像进行处理。填充手部区域以排除手纹影响，最后用canny算子进行边缘检测得到手部轮廓。</p>
<p>本节将根据所写代码，逐步分析并对代码进行解释说明。</p>
<p>本方法受<a href="http://blog.csdn.net/yeyang911/article/details/39120319" target="_blank" rel="external">911的专栏</a>启发。</p>
<h3 id="梯度计算">梯度计算</h3><p>梯度即数值变化的速率，有时等于连续函数的导数。在矩阵计算中，为矩阵中数值变化的速度。梯度详细的数学解释请看<a href="http://baike.baidu.com/subview/454441/12503183.htm" target="_blank" rel="external">百度百科 梯度</a>。</p>
<p>这里用到了matlab中的<code>gradient</code>方法。具体使用方法为</p>
<pre><code>x=[<span class="number">6,9,3,4</span>,<span class="number">0;5,4,1</span>,<span class="number">2,5;6,7</span>,<span class="number">7,8,0;7</span>,<span class="number">8,9,10,0</span>]
x =
 6     9     3     4     0
 5     4     1     2     5
 6     7     7     8     0
 7     8     9    10     0

[Fx,Fy]=gradient(x)
Fx =
3.0000   -1.5000   -2.5000   -1.5000   -4.0000
-1.0000   -2.0000   -1.0000    2.0000    3.0000
1.0000    0.5000    0.5000   -3.5000   -8.0000
1.0000    1.0000    1.0000   -4.5000  -10.0000

Fy =
-1.0000   -5.0000   -2.0000   -2.0000    5.0000
     0   -1.0000    2.0000    2.0000         0
1.0000    2.0000    4.0000    4.0000   -2.5000
1.0000    1.0000    2.0000    2.0000         0
</code></pre><p>其中<code>Fx</code>为其水平方向上的梯度，<code>Fy</code>为其垂直方向上的梯度。计算公式</p>
<pre><code><span class="function"><span class="title">Fx</span><span class="params">(i,j)</span></span>=(<span class="function"><span class="title">F</span><span class="params">(i,j+<span class="number">1</span>)</span></span>-<span class="function"><span class="title">F</span><span class="params">(i,j-<span class="number">1</span>)</span></span>)/<span class="number">2</span>
</code></pre><p>即每一个元素的梯度，为其前一个与后一个之差。</p>
<p>得到的矩阵Fx与Fy，其本质是每一个像素点的相邻像素值的差。差越大，表明其越近似与边缘；差越小，其所在位置是边缘的可能性越低。</p>
<p>根据这个思路，产生如下代码：</p>
<pre><code><span class="comment">% --- Executes on button press in pushbutton3.</span>
<span class="function"><span class="keyword">function</span> <span class="title">pushbutton3_Callback</span><span class="params">(hObject, eventdata, handles)</span></span>
<span class="comment">% hObject    handle to pushbutton3 (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
I=get(gcbf,<span class="string">'UserData'</span>);
I=double(I);
<span class="matrix">[Gx,Gy]</span>=gradient(I);<span class="comment">%分别计算x与y方向的梯度</span>
G=<span class="built_in">sqrt</span>(Gx.*Gx+Gy.*Gy)/<span class="number">255</span>;<span class="comment">%计算每个点的梯度值，产生梯度图G</span>
I2=rgb2gray(G);<span class="comment">%将梯度图G转换为灰度图</span>
I2(I2&lt;<span class="number">5</span>/<span class="number">255</span>)=<span class="number">0</span>;<span class="comment">%设定阈值为5/255，即当梯度小于5/255时视为非边缘，显示黑色</span>
I2(I2&gt;=<span class="number">5</span>/<span class="number">255</span>)=<span class="number">1</span>;<span class="comment">%当梯度大于5/255视为边缘，显示白色；</span>
imwrite(I2, <span class="string">'D:\im1.jpg'</span>);<span class="comment">%保存边缘图，为黑白两色二值图</span>
</code></pre><p>得到的二值图如下：<br><img src="http://ww3.sinaimg.cn/large/4aa86401gw1etvkay5cshj20zk0k045s.jpg" alt="im1"></p>
<p>有关梯度的知识参考了<a href="http://blog.sina.com.cn/s/blog_53be544e0101cd8a.html" target="_blank" rel="external">童心未泯的博客</a>以及<a href="http://www.ilovematlab.cn/thread-40710-1-1.html" target="_blank" rel="external">matlab中文论坛</a></p>
<h3 id="膨胀与腐蚀">膨胀与腐蚀</h3><p>膨胀与腐蚀是图像处理中的两项基本操作，目的是消除图像中的噪声点。</p>
<p><strong>腐蚀</strong>:用一个结构元素(一般是3×3的大小)扫描图像中的每一个像素，用结构元素中的每一个像素与其覆盖的像素做“与”操作，如果都为1，则该像素为1，否则为0。 </p>
<p><strong>膨胀</strong>:用一个结构元素(一般是3×3的大小)扫描图像中的每一个像素，用结构元素中的每一个像素与其覆盖的像素做“与”操作，如果都为0，则该像素为0，否则为1。</p>
<p><strong>腐蚀的作用</strong>:消除物体边界点，使目标缩小，可以消除小于结构元素的噪声点；</p>
<p><strong>膨胀的作用</strong>:将与物体接触的所有背景点合并到物体中，使目标增大，可添补目标中的空洞。  </p>
<p><strong>开运算</strong>:先腐蚀后膨胀的过程，可以消除图像上细小的噪声，并平滑物体边界。  </p>
<p><strong>闭运算</strong>:先膨胀后腐蚀的过程，可以填充物体内细小的空洞，并平滑物体边界。</p>
<p>*参考了<a href="http://wenku.baidu.com/view/9cc3271ec281e53a5802ff93.html" target="_blank" rel="external">百度文库</a>请参见。</p>
<p>这里使用了闭运算，即先腐蚀后膨胀。目的是将边缘曲线闭合，消除边缘曲线上的空白点，以便后面的填充操作。在闭运算之前，先进行了一次噪声消除，去掉图像中的孤立点。</p>
<p>代码：</p>
<pre><code>BW2=bwmorph<span class="list">(<span class="keyword">I2</span>,<span class="quoted">'clean</span>')</span><span class="comment">;%清洁操作</span>
BW2=bwmorph<span class="list">(<span class="keyword">BW2</span>, <span class="quoted">'dilate</span>')</span><span class="comment">;%膨胀操作</span>
BW2=bwmorph<span class="list">(<span class="keyword">BW2</span>, <span class="quoted">'erode</span>')</span><span class="comment">;%腐蚀操作</span>
</code></pre><p>有关<code>bwmorph</code>方法的使用，参见<a href="http://blog.sina.com.cn/s/blog_6f2d29af0101060n.html" target="_blank" rel="external">阳光雨露的博客</a></p>
<p>膨胀腐蚀后的手部轮廓图如下</p>
<p><img src="http://ww1.sinaimg.cn/large/4aa86401gw1etvkb3kjuhj20zk0k00za.jpg" alt="im2"></p>
<h3 id="手部填充">手部填充</h3><p>为了消除手纹的影响，采用填充手部区域的方法。由于该方法只填充手轮廓曲线，而不会填充手部之外的非封闭曲线，因此可以增加手部边界的准确度，部分去除阴影与背景噪声的影响。</p>
<p>采用imfill函数。具体函数的使用方法参见了<a href="http://www.ilovematlab.cn/thread-74613-1-1.html" target="_blank" rel="external">matlab中文论坛</a></p>
<p><code>imfill</code>会填充二值图中的封闭区域。但是这里有一个问题。如果区域连接了图片边缘，则被判定为开放区域。而在手部图像中，手腕是会被识别为手部的，因此刚得到的手部粗轮廓中，由于手腕处于图像边缘，手部轮廓是一个开放区域，不能被填充。</p>
<p>为解决这一问题，将图像中的左、右与下边缘进行边缘填充。即将这三个边缘的像素点都置为白色。</p>
<p>代码：</p>
<pre><code><span class="list">[<span class="keyword">rows</span>,cols]=size<span class="list">(<span class="keyword">BW2</span>)</span><span class="comment">;%记录图片长、宽</span>
BW2<span class="list">(<span class="keyword">:</span>,<span class="number">1</span>)</span>=1<span class="comment">;%left set 1</span>
BW2<span class="list">(<span class="keyword">:</span>,cols)</span>=1<span class="comment">;%right set 1</span>
BW2<span class="list">(<span class="keyword">rows</span>,:)</span>=1<span class="comment">;%bottom set 1</span>

imwrite<span class="list">(<span class="keyword">BW2</span>, <span class="variable">'D:</span>\im2.jpg')</span><span class="comment">;%保存图片用于观察</span>

BW3=imfill<span class="list">(<span class="keyword">BW2</span>, <span class="variable">'holes</span>')</span><span class="comment">;</span>
BW3<span class="list">(<span class="keyword">:</span>,<span class="number">1</span>)</span>=0<span class="comment">;</span>
BW3<span class="list">(<span class="keyword">:</span>,cols)</span>=0<span class="comment">;%right set 0</span>
BW3<span class="list">(<span class="keyword">rows-1</span>,:)</span>=0<span class="comment">;%bottom set 0%不知道为什么有时图片下面两行都被设为1了。有待于进一步研究</span>
BW3<span class="list">(<span class="keyword">rows</span>,:)</span>=0<span class="comment">;%bottom set 0</span>

imwrite<span class="list">(<span class="keyword">BW3</span>, <span class="variable">'D:</span>\im3.jpg')</span><span class="comment">;</span></span>
</code></pre><p>这里用到了矩阵的部分操作。</p>
<p>size用来读取矩阵的大小，这里保存在<code>rows</code>与<code>cols</code>中。</p>
<p>矩阵中位于(x,y)处的值表示为<code>I(x,y)</code>。可进行赋值操作</p>
<pre><code>I<span class="list">(<span class="keyword">x</span>,y)</span>=1<span class="comment">;</span>
</code></pre><p>在matlab中，冒号 <code>:</code>表示范围。例如，从1到i可以表示为</p>
<pre><code><span class="number">1</span><span class="attribute">:i</span>
</code></pre><p>将矩阵的第一列（最左列）全部赋值为0，可以表示为</p>
<pre><code><span class="function">I</span>(<span class="value">:,<span class="number">1</span>)=<span class="number">0</span>;</span>
</code></pre><p>这里的意思是，对于所有行的元素（用<code>:</code>表示），其第一列（逗号后面的1）赋值为0。</p>
<p>手部填充后的手部图如下</p>
<p><img src="http://ww1.sinaimg.cn/large/4aa86401gw1etvkb8doz5j20zk0k0jrz.jpg" alt="im3"></p>
<h3 id="轮廓精提取">轮廓精提取</h3><p>得到填充区域后，采用canny算子进行轮廓提取，得到手部精轮廓。</p>
<p>canny算子边缘检测是一种目前比较常用与优秀的边缘检测方法。有关canny算子的详细介绍，请参见<a href="https://zh.wikipedia.org/wiki/Canny%E7%AE%97%E5%AD%90" target="_blank" rel="external">维基百科</a>或自行百度<code>canny 边缘检测</code></p>
<p>这里由于只是进行简单图形的边缘检测，因此直接调用matlab所提供的方法<code>edge</code>。有关<code>edge</code>方法的粗略介绍可以参考<a href="http://blog.sina.com.cn/s/blog_6c8f4cc801014at3.html" target="_blank" rel="external">落寞的博客</a>。详细介绍还是要看<a href="http://au.mathworks.com/help/images/ref/edge.html" target="_blank" rel="external">matlab官方文档</a></p>
<p>代码：</p>
<pre><code>set<span class="list">(<span class="keyword">gcbf</span>,<span class="quoted">'UserData</span>',BW3)</span><span class="comment">;</span>
BW3=edge<span class="list">(<span class="keyword">BW3</span>,<span class="quoted">'canny</span>')</span><span class="comment">;%用canny算计做边缘检测</span>
imwrite<span class="list">(<span class="keyword">BW3</span>, <span class="quoted">'D</span>:\im4.jpg')</span><span class="comment">;</span>
axes<span class="list">(<span class="keyword">handles</span>.axes3)</span><span class="comment">;%显示到axes3中</span>
imshow<span class="list">(<span class="keyword">BW3</span>)</span><span class="comment">;</span>
</code></pre><p>至此，手部轮廓提取完毕。得到的手部轮廓图如下</p>
<p><img src="http://ww3.sinaimg.cn/large/4aa86401gw1etvkbavskaj20zk0k0gmb.jpg" alt="im4"></p>
<h2 id="中指指尖检测">中指指尖检测</h2><p>这里的中指指尖检测采用了相对简单的方法，即重心距离法。首先找到手部的重心，然后找到距离重心最远的边缘点，即判定为中指指尖位置。该方法受到了<a href="http://blog.csdn.net/zouxy09/article/details/8711461" target="_blank" rel="external">zouxy09的专栏</a>以及<a href="http://blog.csdn.net/onezeros/article/details/6196095" target="_blank" rel="external">onezeros的专栏</a>的启发。</p>
<h3 id="重心定位">重心定位</h3><p>由于手部区域被保存在二值图中，因此手部重心即为二值图中白色区域的重心。</p>
<p>在二值图中，1表示像素点为白色，0表示黑色，而矩阵中x y的值即为其图像中位置。因此，<strong>手部重心坐标即为二值图中所有值为1的点的坐标值之和，除以值为1的点的个数</strong>。</p>
<p>重心的计算参考了<a href="http://zhidao.baidu.com/question/161892545.html?fr=iks&amp;word=matlab+%D6%D8%D0%C4&amp;ie=gbk" target="_blank" rel="external">百度知道</a>以及<a href="http://wenda.tianya.cn/question/1a4eaeb7acdfbf1a" target="_blank" rel="external">天涯问答</a></p>
<p>代码</p>
<pre><code><span class="comment">% --- Executes on button press in pushbutton4.</span>
<span class="function"><span class="keyword">function</span> <span class="title">pushbutton4_Callback</span><span class="params">(hObject, eventdata, handles)</span></span>
<span class="comment">% hObject    handle to pushbutton4 (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
BW3=get(gcbf,<span class="string">'UserData'</span>);
<span class="matrix">[rows,cols]</span>=<span class="built_in">size</span>(BW3);
x=<span class="built_in">ones</span>(rows,<span class="number">1</span>)*<span class="matrix">[<span class="number">1</span>:cols]</span>;<span class="comment">%注1 ones矩阵</span>
y=<span class="matrix">[<span class="number">1</span>:rows]</span><span class="operator">'</span>*<span class="built_in">ones</span>(<span class="number">1</span>,cols);<span class="comment">%注2 矩阵运算</span>
area=sum(sum(BW3));<span class="comment">%注3 sum函数</span>
meanx=sum(sum(BW3.*x))/area;<span class="comment">%注4 ".*"运算</span>
meany=sum(sum(BW3.*y))/area;
mx=int32(meanx);<span class="comment">%注5 类型转换</span>
my=int32(meany);
</code></pre><p><strong>注1 ones矩阵</strong><br>ones用来产生全1矩阵。<code>ones(m,n)</code>即产生一个m*n的矩阵，其中所有的值均为1。这里我们产生了两个全1矩阵，分别是单行全1（<code>ones(1,cols)</code>）与单列全1（<code>ones(rows,1)</code>）。用这两个矩阵分别与列坐标矩阵<code>[1:rows]</code>和行坐标矩阵<code>[1:cols]</code>相乘，得到了整幅图像的坐标矩阵x与y。</p>
<p><strong>注2 矩阵运算</strong><br>matlab提供了丰富而强大的矩阵运算功能。本文参考了<a href="http://blog.csdn.net/dengjianqiang2011/article/details/8753807" target="_blank" rel="external">dengjianqiang2011的专栏</a>。</p>
<p>这里用到两种矩阵运算</p>
<ol>
<li>转置矩阵</li>
</ol>
<p>使用符号<code>` </code>来表示矩阵的转置。有关转置矩阵的定义参见<a href="http://baike.baidu.com/view/1659988.htm" target="_blank" rel="external">百度百科</a></p>
<ol>
<li>矩阵乘法</li>
</ol>
<p>即矩阵相乘，用<code>*</code>来表示矩阵相乘。</p>
<p><strong>注3 sum函数</strong><br>sum函数可求得矩阵某一行或某一列元素之和。具体用法请参考<a href="http://blog.sina.com.cn/s/blog_4af3f0d20100c90f.html" target="_blank" rel="external">菜鸟的博客</a>。<br>这里，<code>sum(BW3)</code>是对矩阵BW3按行求和，求和的结果仍然为一个矩阵。这时再对这个矩阵进行求和，即<code>sum(sum(BW3))</code>，得到的结果为整个BW3矩阵所有元素之和。</p>
<p>由于BW3为手部区域二值化图像，白点的值为1，黑点为0，因此其总的元素之和，即为其中白点数量。</p>
<p><strong>注4 “.*”运算</strong><br><code>.*</code>运算为一种特殊的矩阵运算，其意义为两个矩阵中对应元素相乘，得到新的矩阵。具体解释请参见<a href="http://blog.csdn.net/dengjianqiang2011/article/details/8753807" target="_blank" rel="external">dengjianqiang2011的专栏</a>。</p>
<blockquote>
<p>“点运算在MATLAB中，有一种特殊的运算，因为其运算符是在有关算术运算符前面加点，所以叫点运算。点运算符有.*、./、.\和.^。两矩阵进行点运算是指它们的对应元素进行相关运算，要求两矩阵的维参数相同。”</p>
</blockquote>
<p>这里，<code>BW3.*x</code>表示用BW3中每一个元素，与全坐标矩阵x相乘。所得结果即为BW3中每一个值为1的点（白点，即手部区域）的坐标矩阵（其余点的值为0）。将该矩阵求和（sum运算），即为所有手部点的坐标和。用该坐标和除以手部点的个数（area），所得结果即重心的x坐标。</p>
<p><strong>注5 类型转换</strong><br>刚才得到的重心坐标为float类型（小数类型），而图像中的坐标都是int类型（整数型）。因此需要类型转换。</p>
<h3 id="寻找最远点">寻找最远点</h3><p>基本思路是通过遍历整个图像，找到距离重心最远的白点（值为1的点）。因此需要用到一个二重循环。</p>
<p>两点间距离采用欧氏距离。因为开平方运算比较耗时，并且这里只需要比较大小而不需要知道距离的精确值，因此只计算欧氏距离的平方。</p>
<pre><code>dist=<span class="comment">(i-my)</span>^<span class="number">2</span>+<span class="comment">(j-mx)</span>^<span class="number">2</span>;
</code></pre><p>其中，i与j为遍历点的坐标，mx与my为重心的坐标。</p>
<p>整个算法伪代码如下</p>
<pre><code>已测得最大距离maxdi=<span class="number">0</span>；
<span class="keyword">for</span>循环：遍历 纵坐标<span class="built_in">i</span>从<span class="number">1</span>到最大值rows
    <span class="keyword">for</span>循环：遍历 横坐标<span class="built_in">j</span>从<span class="number">1</span>到最大值cols
        如果 点（<span class="built_in">i</span>,<span class="built_in">j</span>）的值为<span class="number">1</span>
            计算距离dist=(<span class="built_in">i</span>-my)^<span class="number">2</span>+(<span class="built_in">j</span>-mx)^<span class="number">2</span>;
            如果 当前距离dist 大于 最大距离maxdi
                最大距离maxdi更新为dist
                记录改点坐标
            结束如果
        结束如果
    结束<span class="keyword">for</span>
结束<span class="keyword">for</span>
</code></pre><p>根据伪代码，产生代码如下</p>
<pre><code>maxdi=<span class="number">0</span>;
<span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:rows
<span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:cols
<span class="keyword">if</span> BW3(<span class="built_in">i</span>,<span class="built_in">j</span>)==<span class="number">1</span>
dist=(<span class="built_in">i</span>-my)^<span class="number">2</span>+(<span class="built_in">j</span>-mx)^<span class="number">2</span>;
<span class="keyword">if</span> dist&gt;maxdi
maxdi=dist;
maxx=<span class="built_in">i</span>;
maxy=<span class="built_in">j</span>;
<span class="keyword">end</span>
<span class="keyword">end</span>
<span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre><p>条件与循环语句参考了<a href="http://blog.sina.com.cn/s/blog_54746e15010003aj.html" target="_blank" rel="external">绿叶怀古的博客</a></p>
<p>*注 这里可以进行一些优化，比如不必遍历最底部的点。另外matlab中变量的作用域有待学习。这里maxx与maxy的作用域显然不限于for循环中。</p>
<h3 id="中指位置标示">中指位置标示</h3><p>为了简单起见，这里将中指指尖位置所在行与列全部画为白色（矩阵置1）</p>
<pre><code>BW3=edge<span class="list">(<span class="keyword">BW3</span>,<span class="quoted">'canny</span>')</span><span class="comment">;</span>
BW3<span class="list">(:,maxy)</span>=1<span class="comment">;</span>
BW3<span class="list">(<span class="keyword">maxx</span>,:)</span>=1<span class="comment">;</span>
axes<span class="list">(<span class="keyword">handles</span>.axes4)</span><span class="comment">;</span>
imshow<span class="list">(<span class="keyword">BW3</span>)</span><span class="comment">;</span>
</code></pre><h3 id="中指坐标显示">中指坐标显示</h3><p>在guide界面中显示坐标值。采用静态文本框标示。</p>
<p>与button类似，拖入静态文本框，修改string中的值，然后加入如下代码。其中显示x与y坐标的文本框的id分别为text1与text3。文本框id即为其tag字段值。</p>
<pre><code>set<span class="list">(<span class="keyword">handles</span>.text1, <span class="quoted">'String</span>',maxy)</span><span class="comment">;</span>
set<span class="list">(<span class="keyword">handles</span>.text3, <span class="quoted">'String</span>',maxx)</span><span class="comment">;</span>
</code></pre><p>静态文本框的显示参考了<a href="http://www.matlabsky.com/thread-24884-1-1.html" target="_blank" rel="external">matlab技术论坛</a></p>
<p>最终界面如下</p>
<p><img src="http://ww3.sinaimg.cn/large/4aa86401gw1etvkaum65kj20lh0d340z.jpg" alt="final"></p>
<h2 id="总结">总结</h2><p>至此，整个程序完成。</p>
<h3 id="缺点与限制">缺点与限制</h3><ol>
<li>本文用白纸作为背景进行测试，其他未测试。理论上要求背景简单，即无其他物体干扰。背景颜色尽量区别于肤色。</li>
<li>手腕在左侧通过了测试，但右侧没有测试，理论上应该可以正常使用</li>
<li>除了手腕，其他手部尽量不要触碰边框，会造成部分区域在填充时出现错误。</li>
<li>因为有光照阴影影响，实际测试的时候可能手部面积会变大（阴影部分可能识别为手部）</li>
<li>由于摄像头分辨率高，而屏幕较小，图片在显示时会被缩小，因此部分区域无法正常显示，尤其是手部轮廓只有一个像素点，会显示为虚线。因此实验结果以保存的原图为准。</li>
</ol>
<h3 id="可能的改进">可能的改进</h3><ol>
<li>背景噪声控制。本方法对背景噪音非常敏感，可以考虑通过使用滤波消除背景噪音。</li>
<li>手部区域的检测可以通过肤色识别来更精确的实现。将图片映射到HSV颜色空间中，消除光照影响，然后转为灰度图，设定肤色范围，从而达到识别手部轮廓的目的。该方法的缺点是手部轮廓不够精确，因而影响后面的指尖定位。</li>
<li>指尖定位方法较为简单，但是考虑到要求只定位中指，重点问题在于如何与其他指尖相互区别。可以考虑采用直线拟合，定位出手指边缘直线位置，从而找到中指所在边缘。但该方法仅适用于五指张开手势，对于其他手势效果会有影响。而中指定位通常需要借助数据手套或者标记点来实现。</li>
<li>作者曾试图在图片中用红圈标记出指尖位置，未能成功。该功能有待于进一步研究。</li>
<li>在前文提到，在给图片加白色边界后，出现底部边界宽度为2的情况。为何有此现象有待于进一步研究。</li>
<li>在前文提到，matlab中变量的作用域与java等其他语言不同。这个问题有待于进一步研究。</li>
<li>摄像头视频流的读入功能尚不清楚，仅仅是复制网上例子。代码具体功能与用法有待于进一步研究。</li>
</ol>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://zhaozongyuan.com/2015/07/06/matlabhandfigure/" data-title="matlab手轮廓识别与中指指尖检测 | Z-Zone" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/2015/06/09/endnotemac/"  title="在mac下使用endnote">
 <strong>下一篇：</strong><br/> 
 <span>在mac下使用endnote
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2015/07/06/matlabhandfigure/" data-title="matlab手轮廓识别与中指指尖检测" data-url="http://zhaozongyuan.com/2015/07/06/matlabhandfigure/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#概要"><span class="toc-number">1.</span> <span class="toc-text">概要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Matlab_Guide建立"><span class="toc-number">2.</span> <span class="toc-text">Matlab Guide建立</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#添加按钮（Button）"><span class="toc-number">2.1.</span> <span class="toc-text">添加按钮（Button）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加图片显示（axes）"><span class="toc-number">2.2.</span> <span class="toc-text">添加图片显示（axes）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加按键动作"><span class="toc-number">2.3.</span> <span class="toc-text">添加按键动作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#执行"><span class="toc-number">2.4.</span> <span class="toc-text">执行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#全局变量与变量调用"><span class="toc-number">3.</span> <span class="toc-text">全局变量与变量调用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#全局变量"><span class="toc-number">3.1.</span> <span class="toc-text">全局变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用UserData进行参数传递"><span class="toc-number">3.2.</span> <span class="toc-text">使用UserData进行参数传递</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#摄像头读取"><span class="toc-number">4.</span> <span class="toc-text">摄像头读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#视频流显示"><span class="toc-number">4.1.</span> <span class="toc-text">视频流显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#截取一帧图像"><span class="toc-number">4.2.</span> <span class="toc-text">截取一帧图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图像与矩阵"><span class="toc-number">4.3.</span> <span class="toc-text">图像与矩阵</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#轮廓提取"><span class="toc-number">5.</span> <span class="toc-text">轮廓提取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#梯度计算"><span class="toc-number">5.1.</span> <span class="toc-text">梯度计算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#膨胀与腐蚀"><span class="toc-number">5.2.</span> <span class="toc-text">膨胀与腐蚀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#手部填充"><span class="toc-number">5.3.</span> <span class="toc-text">手部填充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#轮廓精提取"><span class="toc-number">5.4.</span> <span class="toc-text">轮廓精提取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#中指指尖检测"><span class="toc-number">6.</span> <span class="toc-text">中指指尖检测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#重心定位"><span class="toc-number">6.1.</span> <span class="toc-text">重心定位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#寻找最远点"><span class="toc-number">6.2.</span> <span class="toc-text">寻找最远点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中指位置标示"><span class="toc-number">6.3.</span> <span class="toc-text">中指位置标示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中指坐标显示"><span class="toc-number">6.4.</span> <span class="toc-text">中指坐标显示</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">7.</span> <span class="toc-text">总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#缺点与限制"><span class="toc-number">7.1.</span> <span class="toc-text">缺点与限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#可能的改进"><span class="toc-number">7.2.</span> <span class="toc-text">可能的改进</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/中文/" title="中文">中文<sup>6</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/github/" title="github">github<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/hexo/" title="hexo">hexo<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/中文/" title="中文">中文<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/setup/" title="setup">setup<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/建立/" title="建立">建立<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/入门/" title="入门">入门<sup>1</sup></a></li>
			
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Zongyuan Zhao <br/>
			You are welcome to contact me by sending email to zzy198700@hotmail.com</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/https://github.com/zzhao3" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		<a href="mailto:zzy198700@hotmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2015 
		
		<a href="/about" target="_blank" title="Zongyuan Zhao">Zongyuan Zhao</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#nothing"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"zhaozongyuan"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
